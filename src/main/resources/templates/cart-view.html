<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>×—×©×‘×•×Ÿ ×”×œ×§×•×—</title>
    <script src="https://cdn.jsdelivr.net/npm/sockjs-client/dist/sockjs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/stompjs/lib/stomp.min.js"></script>
</head>
<body>
<h2>×”××•×¦×¨×™× ×©× ×¡×¨×§×•</h2>
<ul id="cart-items"></ul>

<script>
    const socket = new SockJS('/ws');
    const stompClient = Stomp.over(socket);

    stompClient.connect({}, function () {
        stompClient.subscribe('/topic/cart', function (message) {

            // âœ… ×”×“×¤×¡ ××ª ×’×•×£ ×”×”×•×“×¢×” ×œ×¤× ×™ ×©×× ×¡×™× ×œ×¤×¢× ×—
            console.log("ğŸ“¨ Raw message:", message.body);

            const items = JSON.parse(message.body);
            const list = document.getElementById('cart-items');
            list.innerHTML = '';

            items.forEach(item => {
                const li = document.createElement('li');
                li.textContent = `${item.productName} Ã— ${item.quantity} = â‚ª${item.totalPrice}`;
                list.appendChild(li);
            });

        });
    });
</script>

</body>
</html>
